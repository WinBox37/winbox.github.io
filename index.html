<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1ä¸–ç•Œå† å†›è®¡ç®—å™¨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #e10600 0%, #b30500 100%);
            border-radius: 15px;
            color: white;
            box-shadow: 0 10px 20px rgba(225, 6, 0, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
        }
        
        .card-title {
            font-size: 1.4rem;
            color: #e10600;
            margin-bottom: 20px;
            padding-left: 10px;
            border-left: 5px solid #e10600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* å† å†›ç»“æœæ˜¾ç¤º */
        .champion-result {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #fff8e1 0%, #fff 100%);
            border: 3px solid #ffd600;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .crown {
            font-size: 4rem;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .champion-name {
            font-size: 2.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .champion-points {
            font-size: 1.5rem;
            color: #666;
        }
        
        .error-message {
            background: #ffebee;
            color: #d32f2f;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
            display: none;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        
        /* è®¾ç½®åæ¬¡åŒºåŸŸ */
        .driver-inputs {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .driver-input {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            border-radius: 12px;
            transition: background 0.3s;
        }
        
        .driver-input:hover {
            background: #f8f9fa;
        }
        
        .driver-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .driver-code {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .driver-name {
            font-size: 1rem;
            color: #666;
        }
        
        .nor { color: #ff9800; }
        .ver { color: #1e88e5; }
        .pia { color: #43a047; }
        
        .position-select {
            width: 120px;
            padding: 12px 15px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            font-size: 1.1rem;
            font-weight: 500;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .position-select:focus {
            border-color: #e10600;
            outline: none;
            box-shadow: 0 0 0 3px rgba(225, 6, 0, 0.1);
        }
        
        /* è®¡ç®—å…¬å¼åŒºåŸŸ */
        .calculation-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .calculation-item {
            display: flex;
            align-items: center;
            padding: 18px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .formula-driver {
            font-size: 1.3rem;
            font-weight: bold;
            width: 80px;
        }
        
        .formula-text {
            flex: 1;
            font-size: 1.1rem;
            color: #333;
            text-align: center;
        }
        
        .tie-hint {
            text-align: center;
            padding: 15px;
            background: #fff3e0;
            border-radius: 10px;
            color: #ff9800;
            font-size: 1.1rem;
            margin-top: 15px;
            display: none;
        }
        
        /* å½“å‰ç§¯åˆ†åŒºåŸŸ */
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .score-item {
            text-align: center;
            padding: 25px 15px;
            border-radius: 12px;
            transition: transform 0.3s;
        }
        
        .score-item:hover {
            transform: scale(1.05);
        }
        
        .score-item.nor {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 183, 77, 0.1));
            border: 2px solid rgba(255, 152, 0, 0.2);
        }
        
        .score-item.ver {
            background: linear-gradient(135deg, rgba(30, 136, 229, 0.1), rgba(100, 181, 246, 0.1));
            border: 2px solid rgba(30, 136, 229, 0.2);
        }
        
        .score-item.pia {
            background: linear-gradient(135deg, rgba(67, 160, 71, 0.1), rgba(102, 187, 106, 0.1));
            border: 2px solid rgba(67, 160, 71, 0.2);
        }
        
        .score-driver {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .score-value {
            font-size: 1.8rem;
            font-weight: 500;
            color: #333;
        }
        
        /* ç§¯åˆ†è§„åˆ™åŒºåŸŸ */
        .rules-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
        }
        
        .rule-item {
            text-align: center;
            padding: 15px 10px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .rule-item:hover {
            transform: scale(1.05);
            background: #e9ecef;
        }
        
        .rule-position {
            display: block;
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .rule-points {
            display: block;
            font-size: 1rem;
            color: #e10600;
            font-weight: bold;
        }
        
        .rule-note {
            text-align: center;
            font-size: 1rem;
            color: #999;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #f0f0f0;
        }
        
        /* é‡ç½®æŒ‰é’® */
        .reset-btn {
            display: block;
            width: 100%;
            padding: 18px;
            background: #f8f9fa;
            color: #666;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .reset-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .champion-name {
                font-size: 1.8rem;
            }
            
            .driver-input {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .position-select {
                width: 100%;
            }
            
            .scores-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .rules-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .rules-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            h1 {
                font-size: 1.7rem;
            }
        }
        
        /* å ä½ç¬¦æ ·å¼ */
        .placeholder {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.2rem;
            background: #f8f9fa;
            border-radius: 12px;
            display: none;
        }
        
        .show {
            display: block;
        }
        
        .hide {
            display: none;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-flag-checkered"></i> F1ä¸–ç•Œå† å†›è®¡ç®—å™¨</h1>
            <p class="subtitle">è¾“å…¥è½¦æ‰‹åæ¬¡ï¼Œå®æ—¶è®¡ç®—ä¸–ç•Œå† å†›å½’å±</p>
        </header>
        
        <!-- 1. ä¸–ç•Œå† å†›ç»“æœ -->
        <div class="card">
            <h2 class="card-title"><i class="fas fa-trophy"></i> ä¸–ç•Œå† å†›</h2>
            
            <!-- é”™è¯¯æç¤º -->
            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-triangle"></i> åæ¬¡ä¸èƒ½ç›¸åŒï¼è¯·é‡æ–°é€‰æ‹©
            </div>
            
            <!-- å† å†›æ˜¾ç¤º -->
            <div class="champion-result" id="championResult">
                <div class="crown">ğŸ†</div>
                <div class="champion-name" id="championName">è¯·è®¾ç½®è½¦æ‰‹åæ¬¡</div>
                <div class="champion-points" id="championPoints">æ€»ç§¯åˆ†ï¼š0åˆ†</div>
            </div>
        </div>
        
        <!-- 2. è®¾ç½®åæ¬¡ -->
        <div class="card">
            <h2 class="card-title"><i class="fas fa-edit"></i> è®¾ç½®åæ¬¡</h2>
            <div class="driver-inputs">
                <!-- NORè¾“å…¥ -->
                <div class="driver-input">
                    <div class="driver-info">
                        <div class="driver-code nor">NOR</div>
                        <div class="driver-name">å…°å¤šÂ·è¯ºé‡Œæ–¯</div>
                    </div>
                    <select class="position-select" id="norPosition">
                        <option value="1">ç¬¬1å</option>
                        <option value="2">ç¬¬2å</option>
                        <option value="3" selected>ç¬¬3å</option>
                        <option value="4">ç¬¬4å</option>
                        <option value="5">ç¬¬5å</option>
                        <option value="6">ç¬¬6å</option>
                        <option value="7">ç¬¬7å</option>
                        <option value="8">ç¬¬8å</option>
                        <option value="9">ç¬¬9å</option>
                        <option value="10">ç¬¬10å</option>
                        <option value="11">ç¬¬11å</option>
                        <option value="12">ç¬¬12å</option>
                        <option value="13">ç¬¬13å</option>
                        <option value="14">ç¬¬14å</option>
                        <option value="15">ç¬¬15å</option>
                        <option value="16">ç¬¬16å</option>
                        <option value="17">ç¬¬17å</option>
                        <option value="18">ç¬¬18å</option>
                        <option value="19">ç¬¬19å</option>
                        <option value="20">ç¬¬20å</option>
                    </select>
                </div>
                
                <!-- VERè¾“å…¥ -->
                <div class="driver-input">
                    <div class="driver-info">
                        <div class="driver-code ver">VER</div>
                        <div class="driver-name">é©¬å…‹æ–¯Â·ç»´æ–¯å¡”æ½˜</div>
                    </div>
                    <select class="position-select" id="verPosition">
                        <option value="1">ç¬¬1å</option>
                        <option value="2" selected>ç¬¬2å</option>
                        <option value="3">ç¬¬3å</option>
                        <option value="4">ç¬¬4å</option>
                        <option value="5">ç¬¬5å</option>
                        <option value="6">ç¬¬6å</option>
                        <option value="7">ç¬¬7å</option>
                        <option value="8">ç¬¬8å</option>
                        <option value="9">ç¬¬9å</option>
                        <option value="10">ç¬¬10å</option>
                        <option value="11">ç¬¬11å</option>
                        <option value="12">ç¬¬12å</option>
                        <option value="13">ç¬¬13å</option>
                        <option value="14">ç¬¬14å</option>
                        <option value="15">ç¬¬15å</option>
                        <option value="16">ç¬¬16å</option>
                        <option value="17">ç¬¬17å</option>
                        <option value="18">ç¬¬18å</option>
                        <option value="19">ç¬¬19å</option>
                        <option value="20">ç¬¬20å</option>
                    </select>
                </div>
                
                <!-- PIAè¾“å…¥ -->
                <div class="driver-input">
                    <div class="driver-info">
                        <div class="driver-code pia">PIA</div>
                        <div class="driver-name">å¥¥æ–¯å¡Â·çš®äºšæ–¯ç‰¹é‡Œ</div>
                    </div>
                    <select class="position-select" id="piaPosition">
                        <option value="1">ç¬¬1å</option>
                        <option value="2">ç¬¬2å</option>
                        <option value="3" selected>ç¬¬3å</option>
                        <option value="4">ç¬¬4å</option>
                        <option value="5">ç¬¬5å</option>
                        <option value="6">ç¬¬6å</option>
                        <option value="7">ç¬¬7å</option>
                        <option value="8">ç¬¬8å</option>
                        <option value="9">ç¬¬9å</option>
                        <option value="10">ç¬¬10å</option>
                        <option value="11">ç¬¬11å</option>
                        <option value="12">ç¬¬12å</option>
                        <option value="13">ç¬¬13å</option>
                        <option value="14">ç¬¬14å</option>
                        <option value="15">ç¬¬15å</option>
                        <option value="16">ç¬¬16å</option>
                        <option value="17">ç¬¬17å</option>
                        <option value="18">ç¬¬18å</option>
                        <option value="19">ç¬¬19å</option>
                        <option value="20">ç¬¬20å</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- 3. è®¡ç®—å…¬å¼ -->
        <div class="card" id="calculationCard">
            <h2 class="card-title"><i class="fas fa-calculator"></i> è®¡ç®—å…¬å¼</h2>
            <div class="calculation-items" id="calculationItems">
                <div class="calculation-item" id="norCalculation">
                    <div class="formula-driver nor">NOR</div>
                    <div class="formula-text">408 + <span id="norRacePoints">0</span> = <span id="norTotal">408</span>åˆ†</div>
                </div>
                <div class="calculation-item" id="verCalculation">
                    <div class="formula-driver ver">VER</div>
                    <div class="formula-text">396 + <span id="verRacePoints">0</span> = <span id="verTotal">396</span>åˆ†</div>
                </div>
                <div class="calculation-item" id="piaCalculation">
                    <div class="formula-driver pia">PIA</div>
                    <div class="formula-text">392 + <span id="piaRacePoints">0</span> = <span id="piaTotal">392</span>åˆ†</div>
                </div>
            </div>
            
            <!-- åŒåˆ†æç¤º -->
            <div class="tie-hint" id="tieHint">
                <i class="fas fa-exclamation-circle"></i> å‡ºç°åŒåˆ†ï¼P1 è·å¾—å† å†›
            </div>
        </div>
        
        <!-- 4. å½“å‰ç§¯åˆ† -->
        <div class="card">
            <h2 class="card-title"><i class="fas fa-chart-bar"></i> å½“å‰ç§¯åˆ†</h2>
            <div class="scores-grid">
                <div class="score-item nor">
                    <div class="score-driver nor">NOR</div>
                    <div class="score-value" id="norBase">408åˆ†</div>
                </div>
                <div class="score-item ver">
                    <div class="score-driver ver">VER</div>
                    <div class="score-value" id="verBase">396åˆ†</div>
                </div>
                <div class="score-item pia">
                    <div class="score-driver pia">PIA</div>
                    <div class="score-value" id="piaBase">392åˆ†</div>
                </div>
            </div>
        </div>
        
        <!-- 5. å…¶ä»– - ç§¯åˆ†è§„åˆ™ -->
        <div class="card">
            <h2 class="card-title"><i class="fas fa-ruler"></i> ç§¯åˆ†è§„åˆ™</h2>
            <div class="rules-grid">
                <div class="rule-item">
                    <span class="rule-position">P1</span>
                    <span class="rule-points">+25åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P2</span>
                    <span class="rule-points">+18åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P3</span>
                    <span class="rule-points">+15åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P4</span>
                    <span class="rule-points">+12åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P5</span>
                    <span class="rule-points">+10åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P6</span>
                    <span class="rule-points">+8åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P7</span>
                    <span class="rule-points">+6åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P8</span>
                    <span class="rule-points">+4åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P9</span>
                    <span class="rule-points">+2åˆ†</span>
                </div>
                <div class="rule-item">
                    <span class="rule-position">P10</span>
                    <span class="rule-points">+1åˆ†</span>
                </div>
            </div>
            <div class="rule-note">
                P11-P20ï¼š0åˆ†
            </div>
        </div>
        
        <!-- é‡ç½®æŒ‰é’® -->
        <button class="reset-btn" id="resetBtn">
            <i class="fas fa-redo"></i> é‡ç½®åæ¬¡
        </button>
    </div>

    <script>
        // åŸºç¡€ç§¯åˆ†
        const baseScores = {
            NOR: 408,
            VER: 396,
            PIA: 392
        };
        
        // æ ¹æ®åæ¬¡è·å–ç§¯åˆ†
        function getPointsByPosition(position) {
            const pointsMap = {
                1: 25,
                2: 18,
                3: 15,
                4: 12,
                5: 10,
                6: 8,
                7: 6,
                8: 4,
                9: 2,
                10: 1
            };
            return pointsMap[position] || 0;
        }
        
        // è·å–DOMå…ƒç´ 
        const norPositionSelect = document.getElementById('norPosition');
        const verPositionSelect = document.getElementById('verPosition');
        const piaPositionSelect = document.getElementById('piaPosition');
        const errorMessage = document.getElementById('errorMessage');
        const championName = document.getElementById('championName');
        const championPoints = document.getElementById('championPoints');
        const championResult = document.getElementById('championResult');
        const calculationCard = document.getElementById('calculationCard');
        const calculationItems = document.getElementById('calculationItems');
        const tieHint = document.getElementById('tieHint');
        const resetBtn = document.getElementById('resetBtn');
        
        // è®¡ç®—å…¬å¼å…ƒç´ 
        const norRacePointsElem = document.getElementById('norRacePoints');
        const verRacePointsElem = document.getElementById('verRacePoints');
        const piaRacePointsElem = document.getElementById('piaRacePoints');
        const norTotalElem = document.getElementById('norTotal');
        const verTotalElem = document.getElementById('verTotal');
        const piaTotalElem = document.getElementById('piaTotal');
        
        // å½“å‰ç§¯åˆ†å…ƒç´ 
        const norBaseElem = document.getElementById('norBase');
        const verBaseElem = document.getElementById('verBase');
        const piaBaseElem = document.getElementById('piaBase');
        
        // åˆå§‹åŒ–æ˜¾ç¤ºå½“å‰ç§¯åˆ†
        norBaseElem.textContent = baseScores.NOR + 'åˆ†';
        verBaseElem.textContent = baseScores.VER + 'åˆ†';
        piaBaseElem.textContent = baseScores.PIA + 'åˆ†';
        
        // æ£€æŸ¥åæ¬¡æ˜¯å¦é‡å¤å¹¶è®¡ç®—å† å†›
        function checkAndCalculate() {
            // è·å–å½“å‰é€‰æ‹©çš„åæ¬¡
            const norPos = parseInt(norPositionSelect.value);
            const verPos = parseInt(verPositionSelect.value);
            const piaPos = parseInt(piaPositionSelect.value);
            
            // æ£€æŸ¥åæ¬¡æ˜¯å¦ç›¸åŒ
            const positions = [norPos, verPos, piaPos];
            const hasDuplicate = positions.some((pos, index) => positions.indexOf(pos) !== index);
            
            if (hasDuplicate) {
                // åæ¬¡ç›¸åŒï¼Œæ˜¾ç¤ºé”™è¯¯
                errorMessage.classList.add('show');
                errorMessage.classList.add('fade-in');
                championName.textContent = 'åæ¬¡ä¸èƒ½ç›¸åŒ';
                championPoints.textContent = 'è¯·é‡æ–°é€‰æ‹©åæ¬¡';
                calculationCard.classList.add('hide');
                tieHint.classList.remove('show');
                
                // æ¸…é™¤è®¡ç®—å…¬å¼
                norRacePointsElem.textContent = '0';
                verRacePointsElem.textContent = '0';
                piaRacePointsElem.textContent = '0';
                norTotalElem.textContent = baseScores.NOR;
                verTotalElem.textContent = baseScores.VER;
                piaTotalElem.textContent = baseScores.PIA;
                
                // æ·»åŠ é”™è¯¯æ ·å¼
                championResult.style.background = 'linear-gradient(135deg, #ffebee 0%, #fff 100%)';
                championResult.style.borderColor = '#d32f2f';
            } else {
                // åæ¬¡ä¸åŒï¼Œè®¡ç®—å† å†›
                errorMessage.classList.remove('show');
                calculationCard.classList.remove('hide');
                calculateChampion();
                
                // æ¢å¤å† å†›æ ·å¼
                championResult.style.background = 'linear-gradient(135deg, #fff8e1 0%, #fff 100%)';
                championResult.style.borderColor = '#ffd600';
            }
        }
        
        // è®¡ç®—å† å†›
        function calculateChampion() {
            // è·å–å½“å‰é€‰æ‹©çš„åæ¬¡
            const norPos = parseInt(norPositionSelect.value);
            const verPos = parseInt(verPositionSelect.value);
            const piaPos = parseInt(piaPositionSelect.value);
            
            // è®¡ç®—æœ¬åœºç§¯åˆ†
            const norRacePoints = getPointsByPosition(norPos);
            const verRacePoints = getPointsByPosition(verPos);
            const piaRacePoints = getPointsByPosition(piaPos);
            
            // è®¡ç®—æ€»ç§¯åˆ†
            const norTotal = baseScores.NOR + norRacePoints;
            const verTotal = baseScores.VER + verRacePoints;
            const piaTotal = baseScores.PIA + piaRacePoints;
            
            // æ›´æ–°è®¡ç®—å…¬å¼æ˜¾ç¤º
            norRacePointsElem.textContent = norRacePoints;
            verRacePointsElem.textContent = verRacePoints;
            piaRacePointsElem.textContent = piaRacePoints;
            norTotalElem.textContent = norTotal;
            verTotalElem.textContent = verTotal;
            piaTotalElem.textContent = piaTotal;
            
            // ç¡®å®šå† å†›
            determineChampion(norPos, verPos, piaPos, norTotal, verTotal, piaTotal);
        }
        
        // ç¡®å®šå† å†›ï¼ˆå¤„ç†åŒåˆ†æƒ…å†µï¼‰
        function determineChampion(norPos, verPos, piaPos, norTotal, verTotal, piaTotal) {
            // åˆ›å»ºè½¦æ‰‹æ•°ç»„
            const drivers = [
                { 
                    code: 'NOR', 
                    name: 'å…°å¤šÂ·è¯ºé‡Œæ–¯',
                    position: norPos,
                    points: norTotal,
                    basePoints: baseScores.NOR,
                    racePoints: getPointsByPosition(norPos)
                },
                { 
                    code: 'VER', 
                    name: 'é©¬å…‹æ–¯Â·ç»´æ–¯å¡”æ½˜',
                    position: verPos,
                    points: verTotal,
                    basePoints: baseScores.VER,
                    racePoints: getPointsByPosition(verPos)
                },
                { 
                    code: 'PIA', 
                    name: 'å¥¥æ–¯å¡Â·çš®äºšæ–¯ç‰¹é‡Œ',
                    position: piaPos,
                    points: piaTotal,
                    basePoints: baseScores.PIA,
                    racePoints: getPointsByPosition(piaPos)
                }
            ];
            
            // å…ˆæŒ‰æ€»ç§¯åˆ†æ’åº
            drivers.sort((a, b) => b.points - a.points);
            
            // æ£€æŸ¥æ˜¯å¦æœ‰åŒåˆ†
            const topScore = drivers[0].points;
            const isTie = drivers.filter(d => d.points === topScore).length > 1;
            
            let championDriver = '';
            let championTotalPoints = topScore;
            
            if (isTie) {
                // å¦‚æœæœ‰åŒåˆ†ï¼ŒæŒ‰è§„åˆ™å¤„ç†ï¼šå½“å‰P1ä¸ºå† å†›
                // æ‰¾å‡ºè°æ˜¯P1
                const p1Driver = drivers.find(d => d.position === 1);
                if (p1Driver) {
                    championDriver = `${p1Driver.code} ${p1Driver.name}`;
                    championTotalPoints = p1Driver.points;
                } else {
                    // å¦‚æœæ²¡æœ‰P1ï¼ˆç†è®ºä¸Šä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰ï¼Œå–ç¬¬ä¸€ä¸ª
                    championDriver = `${drivers[0].code} ${drivers[0].name}`;
                }
                
                // æ˜¾ç¤ºåŒåˆ†æç¤º
                tieHint.classList.add('show');
                tieHint.classList.add('fade-in');
            } else {
                // æ²¡æœ‰åŒåˆ†ï¼Œæœ€é«˜åˆ†è€…è·èƒœ
                championDriver = `${drivers[0].code} ${drivers[0].name}`;
                
                // éšè—åŒåˆ†æç¤º
                tieHint.classList.remove('show');
            }
            
            // æ›´æ–°å† å†›æ˜¾ç¤º
            championName.textContent = championDriver;
            championPoints.textContent = `æ€»ç§¯åˆ†ï¼š${championTotalPoints}åˆ†`;
            championResult.classList.add('fade-in');
            
            // ç§»é™¤åŠ¨ç”»ç±»ä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨
            setTimeout(() => {
                championResult.classList.remove('fade-in');
            }, 500);
        }
        
        // é‡ç½®åæ¬¡
        function resetPositions() {
            norPositionSelect.value = '3';  // P3
            verPositionSelect.value = '2';  // P2
            piaPositionSelect.value = '1';  // P1
            
            // é‡æ–°è®¡ç®—
            checkAndCalculate();
            
            // æ·»åŠ é‡ç½®åŠ¨ç”»æ•ˆæœ
            const selects = document.querySelectorAll('.position-select');
            selects.forEach(select => {
                select.style.transform = 'scale(1.05)';
                select.style.transition = 'transform 0.3s';
                setTimeout(() => {
                    select.style.transform = 'scale(1)';
                }, 300);
            });
        }
        
        // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
        norPositionSelect.addEventListener('change', checkAndCalculate);
        verPositionSelect.addEventListener('change', checkAndCalculate);
        piaPositionSelect.addEventListener('change', checkAndCalculate);
        resetBtn.addEventListener('click', resetPositions);
        
        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡è®¡ç®—
        window.addEventListener('DOMContentLoaded', () => {
            // é»˜è®¤è®¾ç½®ä¸ºNOR P3, VER P2, PIA P1
            norPositionSelect.value = '3';
            verPositionSelect.value = '2';
            piaPositionSelect.value = '1';
            
            // è®¡ç®—å¹¶æ˜¾ç¤ºç»“æœ
            checkAndCalculate();
        });
        
        // æ·»åŠ ä¸€äº›äº¤äº’æ•ˆæœ
        document.querySelectorAll('.position-select').forEach(select => {
            select.addEventListener('focus', function() {
                this.style.boxShadow = '0 0 0 3px rgba(225, 6, 0, 0.2)';
            });
            
            select.addEventListener('blur', function() {
                this.style.boxShadow = 'none';
            });
        });
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(event) {
            // Ctrl+R æˆ– Cmd+R é‡ç½®
            if ((event.ctrlKey || event.metaKey) && event.key === 'r') {
                event.preventDefault();
                resetPositions();
            }
            
            // ESC é”®é‡ç½®
            if (event.key === 'Escape') {
                resetPositions();
            }
        });
    </script>
</body>
</html>
